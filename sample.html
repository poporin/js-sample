<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="assets/css/bootstrap.min.css" />
    <title></title>
    <h3> JS Sample </h3>
    <label >1. File input</label>
    <input type="file" id="files" name="files[]" class="file" accept="text/plain" />

    <script src="assets/js/libs/dc1-client-js-sample.js"></script>
    <script src="assets/js/libs/jquery-2.1.3.min.js"></script>
    <script src="assets/js/Conf.js"></script>
    <script src="assets/js/model/File.js"></script>
    <script>

        var handleFileSelect = function(evt){
            var selectedFile = evt.target.files[0];
            File.name = selectedFile.name;
            File.type = selectedFile.type;

            var reader = new FileReader();

            reader.onload = (function(theFile) {
                return function(e){
                    File.data =e.target.result;
                }
            })(selectedFile);
            reader.readAsText(selectedFile);
        };

        document.getElementById('files').addEventListener('change', handleFileSelect, false);

        var uploadFileToPIO = function() {
            var dcx = new dcc.DcContext(Conf.UNITURL);
            var acc = dcx.asAccount(Conf.CELLNAME , Conf.ACCOUNTNAME, Conf.PASSWORD);
            var cell = acc.cell();

            var uploadFileName = File.name;
            var options = {
                body : File.data,
                headers : {
                    "Content-Type" : File.type,
                    "If-Match" : "*"
                }
            };

            cell.box('piobox').col('col').put(uploadFileName, options);
        };

        var downloadFileFromPIO = function(){
            var dcx = new dcc.DcContext(Conf.UNITURL);
            var acc = dcx.asAccount(Conf.CELLNAME , Conf.ACCOUNTNAME, Conf.PASSWORD);
            var cell = acc.cell();

            var options = {
                headers : {
                    "Accept" : File.type,
                    "If-Match" : "*"
                }
            };

            var resp = cell.box('piobox').col('col').getAsResponse(File.name,'',options,'');

        };

        $(document).ready(
                function(){
                    $("#uploadButton").click(
                            function(){
                                uploadFileToPIO();
                            }
                    )
                }
        );

    </script>
</head>
<body>

<br>
<label >2. File upload</label>
<p>
<button type="button" id="uploadButton" class="btn btn-default">UPLOAD</button>
</p>
<br>

</body>
</html>